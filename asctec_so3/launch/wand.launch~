<launch>

  <arg name="port" value="/dev/ttyUSB0" />
  <arg name="q_name" value="hummingbird_1" />
  <arg name="controller" value="asctec_so3_control" />
  <arg name="q_frame" value="/vicon/hummingbird_1/hummingbird_1" />
  <arg name="w_frame" value="/odom" />
	<arg name="rviz" value="wand.rviz"/>
	
  <include file="$(find vicon_bridge)/launch/vicon.launch" />
  
	<node name="rviz" pkg="rviz" type="rviz" args="-d $(find asctec_viz)/rviz/$(arg rviz)" />
	<node pkg="asctec_viz"
		type="asctec_viz_node"
		name="asctec_viz"
		output="screen">
		<param name="topic_name" value="$(arg controller)"/>
	</node>

  <node pkg="asctec_so3"
    type="asctec_control_node"
    name="$(arg controller)"
    required="true"
    output="screen">
    <param name="mass" value="0.45"/>
    <rosparam param="gains/pos">[3, 3, 6]</rosparam>
    <rosparam param="gains/vel">[3, 3, 3]</rosparam>

  </node>

  <node pkg="trajectory_gen"
    type="min_accel_node"
    name="min_accel"
    required="true"
    output="screen">
    <param name="rate" value="40"/>
    <param name="topic_name" value="$(arg controller)"/>
  </node>

  <node pkg="asctec_ll_updated" name="$(arg q_name)" type="asctec_ll_updated_node" output="screen" respawn="true">
     <param name="port" value="$(arg port)"/>
     <param name="ll_status_rate" value="1"/>
     <param name="imu_calc_data_rate" value="0"/>
     <param name="rc_data_rate" value="0"/>
     <param name="ctrl_out_rate" value="10"/>
     <param name="gps_data_advanced_rate" value="0"/>
     <remap from="~cmd_si" to="/asctec_so3_control/si_remap" />
  </node>

  <node pkg="asctec_so3"
    type="asctec_vicon_node"
    name="asctec_vicon"
    required="true"
    output="screen">
    <param name="q_name" value="$(arg controller)"/>
    <param name="q_frame" value="$(arg q_frame)"/>
    <param name="w_frame" value="$(arg w_frame)"/>
  </node>

  <node pkg="mesh_visualization"
    type="mesh_visualization"
    name="iris_mesh_visualization"
    output="screen">
    <param name="mesh_resource" value="package://mesh_visualization/meshes/IRIS.STL"/>
    <remap from="~odom_raw" to="iris_odom_raw"/>
    <remap from="~target" to="iris_target"/>
    <remap from="~robot" to="iris_robot"/>
    <remap from="Body" to="iris_body"/>
  </node>

	<node pkg="asctec_so3"
		type="nl_wand_node"
		name="wandy"
		output="screen">
		<param name="q_name" value="$(arg controller)"/>
    <param name="wand_frame" value="/vicon/foam_wand/foam_wand"/>
    <param name="w_frame" value="$(arg w_frame)"/>
		<param name="topic_name" value="$(arg controller)"/>
	</node>

</launch>
